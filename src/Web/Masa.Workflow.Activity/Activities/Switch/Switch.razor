@using Microsoft.JSInterop
@using Microsoft.AspNetCore.Components.Rendering

@inherits Masa.Workflow.ActivityCore.ActivityNode<SwitchActivityMeta>

@inject IJSRuntime jsRuntime

@base.BuildRenderTree

@code {

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await jsRuntime.InvokeAsync<IJSObjectReference>("import", "https://cdn.masastack.com/npm/sortable/Sortable.min.js");
        }
        await base.OnAfterRenderAsync(firstRender);
    }

    protected override void DrawerContent(RenderTreeBuilder __builder)
    {
        <MRow>
            <MCol Cols="12">
                <MTextField @bind-Value="FromModel.Property"
                            Label="Name"
                            Disabled
                            Dense
                            Outlined
                            Prefix="Msg."
                            HideDetails="@("auto")" />
            </MCol>
            <MCol Cols=12>
                <MDragZone>
                    <MDragItem>
                        <div class="white-color item">item1.1</div>
                    </MDragItem>
                    <MDragItem>
                        <div class="white-color item">item1.2</div>
                    </MDragItem>
                </MDragZone>
            </MCol>
            <MCol Cols="12">
                <EnumSelect @bind-Value="FromModel.EnforceRule" TValue="EnforceRule" Clearable=false Label="EnforceRule" />
            </MCol>
        </MRow>
    }


    class SwitchMeta : SwitchActivityMeta, IActivityMeta
    {
        public string Name { get; set; } = "";

        public string Description { get; set; } = "";

        public string Type { get; set; } = "";

        public bool Disabled { get; set; }

        public string Icon { get; set; } = "mdi-shuffle";

        public bool ShowLabel { get; set; } = true;

        public List<string> InputLabels { get; set; } = new();

        public List<string> OutputLabels { get; set; } = new();

        public int Output { get; set; }
    }

}
